# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ API Google Sheet: N_SaleIncentive

## ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ô‡∏µ‡πâ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Sheet ‡∏ä‡∏∑‡πà‡∏≠ "N_SaleIncentive" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡∏°‡∏Ç‡∏≤‡∏¢‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á **"‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö"** ‡πÉ‡∏ô Performance Surgery Schedule Dashboard

---

## üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ

### Google Sheet Information

- **Sheet Name**: `N_SaleIncentive`
- **Spreadsheet ID**: (‡πÉ‡∏ä‡πâ ID ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö "Film data" ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏∏‡πÉ‡∏´‡∏°‡πà)

### Columns Mapping

| Column Name | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á             | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢               | ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á                  |
| ----------- | -------------------------- | ---------------------- | --------------------------- |
| `Sale`      | "‡∏à‡∏µ‡∏ô", "‡πÄ‡∏à", "‡∏ß‡πà‡∏≤‡∏ô", "‡∏°‡∏∏‡∏Å" | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢/‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠   | ‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (Contact Person)  |
| `SaleDate`  | "2025-11-09 10:06:11"      | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ (‡∏£‡∏ß‡∏°‡πÄ‡∏ß‡∏•‡∏≤) | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (‡πÄ‡∏≠‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ) |
| `InCome`    | "10000", "25000"           | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö (‡∏ö‡∏≤‡∏ó)      | ‡∏¢‡∏≠‡∏î‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö                   |

---

## üîß Python API Implementation

### 1. ‡πÄ‡∏û‡∏¥‡πà‡∏° Endpoint ‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô Python API (Railway)

‡∏™‡∏£‡πâ‡∏≤‡∏á endpoint ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å sheet "N_SaleIncentive"

```python
# ‡πÉ‡∏ô main.py ‡∏´‡∏£‡∏∑‡∏≠ app.py
from datetime import datetime

@app.route('/api/sale-incentive', methods=['GET'])
def get_sale_incentive():
    """
    ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å N_SaleIncentive sheet
    """
    try:
        # ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Sheets
        spreadsheet_id = os.getenv('GOOGLE_SPREADSHEET_ID')
        sheet = gc.open_by_key(spreadsheet_id)

        # ‡πÄ‡∏õ‡∏¥‡∏î worksheet ‡∏ä‡∏∑‡πà‡∏≠ "N_SaleIncentive"
        worksheet = sheet.worksheet('N_SaleIncentive')

        # ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        records = worksheet.get_all_records()

        # ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢
        sale_data = []
        for record in records:
            try:
                # ‡πÅ‡∏õ‡∏•‡∏á SaleDate ‡∏à‡∏≤‡∏Å string ‡πÄ‡∏õ‡πá‡∏ô date object
                sale_date_str = record.get('SaleDate', '')
                if sale_date_str:
                    # ‡πÅ‡∏¢‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (‡πÑ‡∏°‡πà‡πÄ‡∏≠‡∏≤‡πÄ‡∏ß‡∏•‡∏≤)
                    sale_date = datetime.strptime(sale_date_str, '%Y-%m-%d %H:%M:%S').date()
                else:
                    continue  # ‡∏Ç‡πâ‡∏≤‡∏° record ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà

                # ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Sale ‡πÅ‡∏•‡∏∞ InCome
                sale_person = record.get('Sale', '').strip()
                income = float(record.get('InCome', 0))

                # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡πÉ‡∏ô list
                sale_data.append({
                    'sale_person': sale_person,
                    'sale_date': sale_date.isoformat(),  # Format: "2025-11-09"
                    'income': income,
                    'day': sale_date.day,
                    'month': sale_date.month,
                    'year': sale_date.year
                })
            except Exception as e:
                # ‡∏Ç‡πâ‡∏≤‡∏° record ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏´‡∏£‡∏∑‡∏≠ format ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
                print(f"Error processing record: {e}")
                continue

        return jsonify({
            'success': True,
            'data': sale_data,
            'total_records': len(sale_data)
        })

    except Exception as e:
        return jsonify({
            'success': False,
            'error': str(e)
        }), 500


@app.route('/api/sale-incentive/by-month', methods=['GET'])
def get_sale_incentive_by_month():
    """
    ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
    Query Parameters:
    - month: ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (1-12)
    - year: ‡∏õ‡∏µ (‡πÄ‡∏ä‡πà‡∏ô 2025)
    """
    try:
        month = int(request.args.get('month', datetime.now().month))
        year = int(request.args.get('year', datetime.now().year))

        # ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Sheets
        spreadsheet_id = os.getenv('GOOGLE_SPREADSHEET_ID')
        sheet = gc.open_by_key(spreadsheet_id)
        worksheet = sheet.worksheet('N_SaleIncentive')
        records = worksheet.get_all_records()

        # ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏µ
        filtered_data = []
        for record in records:
            try:
                sale_date_str = record.get('SaleDate', '')
                if not sale_date_str:
                    continue

                sale_date = datetime.strptime(sale_date_str, '%Y-%m-%d %H:%M:%S').date()

                # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                if sale_date.month == month and sale_date.year == year:
                    sale_person = record.get('Sale', '').strip()
                    income = float(record.get('InCome', 0))

                    filtered_data.append({
                        'sale_person': sale_person,
                        'sale_date': sale_date.isoformat(),
                        'income': income,
                        'day': sale_date.day,
                        'month': sale_date.month,
                        'year': sale_date.year
                    })
            except Exception as e:
                continue

        return jsonify({
            'success': True,
            'data': filtered_data,
            'total_records': len(filtered_data),
            'month': month,
            'year': year
        })

    except Exception as e:
        return jsonify({
            'success': False,
            'error': str(e)
        }), 500
```

---

## üîó Frontend Integration (Next.js/React)

### 2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Utility Function ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `src/utils/saleIncentiveApi.ts`

```typescript
// src/utils/saleIncentiveApi.ts

export interface SaleIncentiveData {
  sale_person: string;
  sale_date: string; // ISO format: "2025-11-09"
  income: number;
  day: number;
  month: number; // 1-12
  year: number;
}

/**
 * ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å N_SaleIncentive sheet
 */
export async function fetchSaleIncentiveData(): Promise<SaleIncentiveData[]> {
  const pythonApiUrl =
    process.env.NEXT_PUBLIC_PYTHON_API_URL ||
    "https://believable-ambition-production.up.railway.app";

  try {
    const response = await fetch(`${pythonApiUrl}/api/sale-incentive`, {
      method: "GET",
      headers: {
        "Content-Type": "application/json",
      },
    });

    if (!response.ok) {
      throw new Error(`API Error: ${response.status} ${response.statusText}`);
    }

    const result = await response.json();

    if (!result.success) {
      throw new Error(result.error || "Failed to fetch sale incentive data");
    }

    return result.data;
  } catch (error) {
    console.error("Error fetching sale incentive data:", error);
    throw error;
  }
}

/**
 * ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
 */
export async function fetchSaleIncentiveByMonth(
  month: number, // 0-11 (JavaScript month)
  year: number
): Promise<SaleIncentiveData[]> {
  const pythonApiUrl =
    process.env.NEXT_PUBLIC_PYTHON_API_URL ||
    "https://believable-ambition-production.up.railway.app";

  try {
    // ‡πÅ‡∏õ‡∏•‡∏á JavaScript month (0-11) ‡πÄ‡∏õ‡πá‡∏ô API month (1-12)
    const apiMonth = month + 1;

    const response = await fetch(
      `${pythonApiUrl}/api/sale-incentive/by-month?month=${apiMonth}&year=${year}`,
      {
        method: "GET",
        headers: {
          "Content-Type": "application/json",
        },
      }
    );

    if (!response.ok) {
      throw new Error(`API Error: ${response.status} ${response.statusText}`);
    }

    const result = await response.json();

    if (!result.success) {
      throw new Error(result.error || "Failed to fetch sale incentive data");
    }

    return result.data;
  } catch (error) {
    console.error("Error fetching sale incentive by month:", error);
    throw error;
  }
}

/**
 * ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ï‡∏≤‡∏°‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠
 * Returns: Map<‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠, Map<‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà, ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏ß‡∏°>>
 */
export function calculateDailyRevenueByPerson(
  data: SaleIncentiveData[],
  month: number, // 0-11
  year: number
): Map<string, Map<number, number>> {
  const revenueMap = new Map<string, Map<number, number>>();

  data.forEach((item) => {
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    if (item.month !== month + 1 || item.year !== year) {
      return;
    }

    const person = item.sale_person;
    const day = item.day;
    const income = item.income;

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á Map ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
    if (!revenueMap.has(person)) {
      revenueMap.set(person, new Map<number, number>());
    }

    const personMap = revenueMap.get(person)!;

    // ‡∏ö‡∏ß‡∏Å‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÜ
    const currentRevenue = personMap.get(day) || 0;
    personMap.set(day, currentRevenue + income);
  });

  return revenueMap;
}

/**
 * ‡πÅ‡∏°‡∏û‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Row ID ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
 */
export const SALE_PERSON_TO_ROW_ID: { [key: string]: string } = {
  ‡∏à‡∏µ‡∏ô: "105-‡∏à‡∏µ‡∏ô",
  ‡∏°‡∏∏‡∏Å: "105-‡∏à‡∏µ‡∏ô", // ‡∏°‡∏∏‡∏Å‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏à‡∏µ‡∏ô
  ‡πÄ‡∏à: "107-‡πÄ‡∏à",
  ‡∏ß‡πà‡∏≤‡∏ô: "108-‡∏ß‡πà‡∏≤‡∏ô",
};
```

---

## üìä ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á "‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö"

### 3. ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï Component `page.tsx`

‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å N_SaleIncentive ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á

```typescript
// ‡πÄ‡∏û‡∏¥‡πà‡∏° import
import {
  fetchSaleIncentiveByMonth,
  calculateDailyRevenueByPerson,
  SaleIncentiveData,
  SALE_PERSON_TO_ROW_ID,
} from "@/utils/saleIncentiveApi";

// ‡πÄ‡∏û‡∏¥‡πà‡∏° state ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Sale Incentive
const [saleIncentiveData, setSaleIncentiveData] = useState<SaleIncentiveData[]>(
  []
);
const [saleRevenueMap, setSaleRevenueMap] = useState<
  Map<string, Map<number, number>>
>(new Map());

// ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç loadData function
const loadData = async (isManualRefresh = false) => {
  if (isManualRefresh) {
    setIsRefreshing(true);
  } else {
    setIsLoading(true);
  }
  setError(null);
  try {
    // Fetch surgery schedule data
    const surgeryData = await fetchSurgeryScheduleFromPythonAPI();
    setSurgeryData(surgeryData);

    // Fetch sale incentive data
    const saleData = await fetchSaleIncentiveByMonth(
      selectedMonth,
      selectedYear
    );
    setSaleIncentiveData(saleData);

    setLastUpdated(new Date());
  } catch (error: any) {
    setError(error.message || "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");
  } finally {
    setIsLoading(false);
    setIsRefreshing(false);
  }
};

// ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï useEffect ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì revenue map
useEffect(() => {
  if (saleIncentiveData.length > 0) {
    const newSaleRevenueMap = calculateDailyRevenueByPerson(
      saleIncentiveData,
      selectedMonth,
      selectedYear
    );
    setSaleRevenueMap(newSaleRevenueMap);
  }
}, [saleIncentiveData, selectedMonth, selectedYear]);

// ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç getCellRevenue function ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å N_SaleIncentive
const getCellRevenue = (day: number, rowId: string): number => {
  const contactPerson = CONTACT_PERSON_MAPPING[rowId];
  if (!contactPerson) return 0;

  // ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å N_SaleIncentive ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å surgery data
  if (rowId === "105-‡∏à‡∏µ‡∏ô") {
    const jinMap = saleRevenueMap.get("‡∏à‡∏µ‡∏ô");
    const mukMap = saleRevenueMap.get("‡∏°‡∏∏‡∏Å");

    const jinRevenue = jinMap?.get(day) || 0;
    const mukRevenue = mukMap?.get(day) || 0;

    return jinRevenue + mukRevenue;
  }

  const personMap = saleRevenueMap.get(contactPerson);
  if (!personMap) return 0;

  return personMap.get(day) || 0;
};
```

---

## üöÄ ‡∏Å‡∏≤‡∏£ Deploy

### 4. Environment Variables

#### Railway (Python API)

‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ Environment Variables ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô:

```
GOOGLE_SPREADSHEET_ID=<your-spreadsheet-id>
GOOGLE_SERVICE_ACCOUNT_EMAIL=<service-account-email>
GOOGLE_SERVICE_ACCOUNT_PRIVATE_KEY=<private-key>
```

#### Vercel (Next.js Frontend)

```
NEXT_PUBLIC_PYTHON_API_URL=https://believable-ambition-production.up.railway.app
```

### 5. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö API

#### Test Health Check

```bash
curl https://believable-ambition-production.up.railway.app/health
```

#### Test Sale Incentive Endpoint

```bash
# ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
curl https://believable-ambition-production.up.railway.app/api/sale-incentive

# ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô 2025)
curl "https://believable-ambition-production.up.railway.app/api/sale-incentive/by-month?month=11&year=2025"
```

---

## ‚úÖ Checklist ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤

- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° sheet "N_SaleIncentive" ‡πÉ‡∏ô Google Spreadsheet
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Service Account ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á sheet
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° endpoint `/api/sale-incentive` ‡πÉ‡∏ô Python API
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° endpoint `/api/sale-incentive/by-month` ‡πÉ‡∏ô Python API
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `saleIncentiveApi.ts` ‡πÉ‡∏ô frontend
- [ ] ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï `page.tsx` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å N_SaleIncentive
- [ ] Deploy Python API ‡πÑ‡∏õ Railway
- [ ] Deploy Frontend ‡πÑ‡∏õ Vercel
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö API endpoints
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á "‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö" ‡πÉ‡∏ô frontend

---

## üìù ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

### Format ‡∏Ç‡∏≠‡∏á SaleDate

- **Input**: `"2025-11-09 10:06:11"` (string)
- **Output**: `"2025-11-09"` (ISO date format, ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤)

### ‡∏Å‡∏≤‡∏£‡πÅ‡∏°‡∏û‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠

| Sale Name | Row ID   | ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô |
| --------- | -------- | --------------- |
| ‡∏à‡∏µ‡∏ô       | 105-‡∏à‡∏µ‡∏ô  | 105-‡∏à‡∏µ‡∏ô & ‡∏°‡∏∏‡∏Å   |
| ‡∏°‡∏∏‡∏Å       | 105-‡∏à‡∏µ‡∏ô  | 105-‡∏à‡∏µ‡∏ô & ‡∏°‡∏∏‡∏Å   |
| ‡πÄ‡∏à        | 107-‡πÄ‡∏à   | 107-‡πÄ‡∏à          |
| ‡∏ß‡πà‡∏≤‡∏ô      | 108-‡∏ß‡πà‡∏≤‡∏ô | 108-‡∏ß‡πà‡∏≤‡∏ô        |

### ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö

- ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏£‡∏ß‡∏°‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠
- ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô ‡∏à‡∏∞‡∏ö‡∏ß‡∏Å‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô
- ‡∏à‡∏µ‡∏ô‡πÅ‡∏•‡∏∞‡∏°‡∏∏‡∏Å‡∏à‡∏∞‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô

---

## üêõ Troubleshooting

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡πÑ‡∏°‡πà‡∏û‡∏ö sheet "N_SaleIncentive"

**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ä‡∏∑‡πà‡∏≠ sheet ‡πÉ‡∏ô Google Spreadsheet ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Date format ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ column "SaleDate" ‡∏°‡∏µ format: `YYYY-MM-DD HH:MM:SS`

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: InCome ‡πÄ‡∏õ‡πá‡∏ô string ‡πÅ‡∏ó‡∏ô number

**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ column "InCome" ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏∑‡πà‡∏ô‡∏õ‡∏ô‡∏≠‡∏¢‡∏π‡πà

---

## üìû Support

‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:

1. Railway logs: https://railway.app/dashboard
2. Vercel logs: https://vercel.com/dashboard
3. Google Sheets API quota ‡πÅ‡∏•‡∏∞ permissions
